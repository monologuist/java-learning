<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!--namespace 用于多个Mapper出现相同的sql时区分不同包-->
<!--动态代理方式,接口和mapper文件是对应的所以要指定对应的接口-->
<mapper namespace="com.nyf.dao.ProductDao">

    <!--    自定义映射关系  默认情况下 mybatis就会按照属性名称来进行映射,我们只需要指定对应不上的即可-->
    <resultMap id="product_map" type="products">
        <!--   指定列名 和属性名称     -->
        <result column="pname" property="name"/>
    </resultMap>


    <!--  定义可重复使用的sql片段  -->
    <sql id="filed">pname,price</sql>


<!--        引用定义好的sql片段-->
<!--        <select id="selectByID" parameterType="int" resultType="Product">-->
<!--            select <include refid="filed"/>  from products where  pid = "${pidss}"-->
<!--        </select>-->


    <!--sql的id 需要接口中的方法名称完全一致-->
    <select id="selectByID" parameterType="int" resultMap="product_map">
        select * from products where  pid = "${pidss}"
    </select>

    <select id="selectByIDorName" parameterType="Products" resultType="products">

        select * from products

        <where>
            <if test="pname != null">
                and pname = #{pname}
            </if>
            <if test="pid != null">
                and pid = #{pid}
            </if>
        </where>
    </select>

    
    <select id="selectProductByIDS" parameterType="int" resultType="products">
        select * from products
        <if test="collection != null">
            where pid in
            <foreach collection="collection" open="(" item="id" separator="," close=")">
                #{id}
            </foreach>
        </if>
    </select>

    <update id="updateProductTest" parameterType="products">
        update products
        <set>
            <if test="pname != null and pname != ''">
                pname = #{pname},
            </if>
            <if test="price != null and price > 0">
                price = #{price},
            </if>
            <if test="pdate != null">
                pdate = #{pdate},
            </if>
            <if test="cid != null and cid != ''">
                cid = #{cid},
            </if>
        </set>
        where pid = #{pid}
    </update>

</mapper>